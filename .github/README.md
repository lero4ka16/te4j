## О проекте
Te4j (Template Engine For Java) - простой шаблонизатор, реализованный на Java.

У него нет никаких зависимостей, которые бы добавлялись в конечный jar файл, он быстрый, 
за счёт того, что шаблон компилируется в `.class` файлы и подгружается в рантайме

## Добавление в свой проект

```
// WIP
```

## Компиляция
Выполнив `./gradlew build`, будет создан файл `output/te4j.jar`

## Функционал

### Значение
Значение — самая простая из возможных функций в данном шаблонизаторе. Оно всегда заключено в `^^`, в отличие от
следующих функций, которые заключены в `<*` и `*>`.

Допустим есть страница: `Hello ^^ user.name ^^`, на Java её можно записать как `"Hello" + object.getUser().getName()`.

Также в значениях можно использовать математические операции, которые есть в Java: Плюс (`+`), Минус (`-`),
Деление (`/`), Умножение (`*`), Остаток деления (`%`), Побитовые операции (`&`, `|`, `>>`, `<<`, `^`).

Примеры использования:

- `^^ message ^^`
- `^^ user.name ^^`
- `^^ user.id + 1 ^^`

### Условия
Условие — логическая функция, которая позволяет вставить текст, если выполнено какое-то условие

Условие выглядит следующим образом: `<* if <condition> *>`, далее идёт текст, который будет вставлен, если это условие
выполнится. Этот текст должен завершиться `<* fi *>`. Также можно сделать `<* else *>`.

Так же, как и в значениях, можно использовать математические операции из Java. Можно также использовать `==` или `!=`.
Строки также можно сравнивать через `==` или `!=`, в отличие от самой Java. Чтобы сравнить
`enum`, нужно перед его именем поставить знак `#`, т.е `<* if some_enum == #ENUM *>`. В Java это будет выглядеть
как `if (object.getSomeEnum() == SomeEnum.ENUM)`

Пример:

```html
<* if user.logged_in *>
<a href="/logout">Logout</a>
<* else *>
<a href="/login">Login</a>
<* fi *>
```

В Java:

```java
if (object.getUser().isLoggedIn()) {
    out.write("<a href=\"/logout\">Logout</a>");
} else {
    out.write("<a href=\"/login\">Login</a>");
}
```

### Цикл
Цикл — функция, которая позволяет сделать итерацию по списку 
или массиву, для каждого элемента сгенерировав определённый текст.

Синтаксис схож с условием: `<* for <element-label> : <from> *>`. Где `<element-label>` - название переменной, как в
самой Java, только без объявления типа этой переменной, а где `<from>` - откуда будут браться элементы, т.е путь до
геттера, который возвращает массив/список. Должен заканчиваться `<* done *>`.

За место `<from>` в тестовых целях можно использовать подобную конструкцию: `[1, 2, 3, 4, 5]`. К сожалению, Java это
Java, так что нужно объявлять тип массива, по умолчанию он Object. Чтобы объявить тип, первым элементом нужно
сделать `&<тип массива>`, т.е `[&int, 1, 2, 3, 4, 5]`

Пример:

```html
<* for user : users *>
User: <a href="^^ user.href ^^">^^ user.name ^^</a>
<* done *>
```

В Java:

```java
for (User user : object.getUsers()) {
    out.write("User: <a href=\""+user.getHref()+"\">"+user.getName()+"</a>");
}
```

### Вложенные шаблоны
Вложенные шаблоны — функция, которая позволяет добавить вам в текущий шаблон другой.

В отличие от остальных функций, не заканчивается ни чем

Синтаксис: `<* include <путь до файла> *>`

### Кейс
Кейс — очень странная и сложная функция, которая позволяет добавить вложенный шаблон по enum или строке. Специально для
этого в функции include можно использовать квадратные скобки: `[<переменная>]`

Должен заканчиваться на `<* esac *>`

Пример:

- ```html
   <* case some_enum *>
   <* include [name].html *>
   <* esac *>
   ```
- ```html
   <* case some_string : ["A", "B", "C"] *>
   <* include [$].html *>
   <* esac *>
   ```

### Фильтры
Фильтры позволяют изменить массив или строку во время выполнения.

Примеры использования:

- `^^ message:lower:capitalize ^^`
- `<* for number : numbers:sorted *>`

Доступные фильтры:

| Название | Описание |
| -------- | -------- |
| sum | Сумма всех элементов массива/списка |
| average | Среднее значение всех элементов из массива/списка |
| max | Максимальное значение из массива/списка |
| min | Минимальное значение из массива/списка |
| floor | Округлить в меньшую сторону |
| ceil | Округлить в большую сторону |
| round | Округлить |
| wrap | Переводит примитивы в объекты, т.е int в Integer и т.д |
| <примитив> | Каст в <примитив> |
| hex | Получить hex строки |
| lower | Перевести строку в нижний регистр |
| upper | Перевести строку в верхний регистр |
| capitalize | Поднять первую букву |
| sorted | Отсортировать массив/список |
| trim | Обрезать пробелы с начала и конца строки |
| striptags | Удалить HTML тэги |
| escapetags | Заменяет HTML-символы на `&#..;` |

## Использование

Использование довольно просто, вы можете загрузить шаблон из ресурсов или из файла, но для начала вам
нужен `TemplateProvider`, его можно создать самим, либо же использовать дефолтный

```java
TemplateProvider;

// Провайдер по умолчанию
//  - Все \r, \n, \t и повторяющиеся пробелы автоматически удаляются
//  - Вложенные шаблоны берутся из папки, в которой запущена программа
provider = Te4j.defaults();

// Кастомный провайдер
provider = Te4j.custom()
        // Ресурсы будут взяты из папки WEB-INF
        .useResources("WEB-INF")
        // По умолчанию стоит ReplaceStrategy.NONE
        //   NONE - никакие символы удалены не будут
        //   ALL - символы \r, \n, \t и повторяющиеся пробелы будут удалены
        //.replaceStrategy(ReplaceStrategy.ALL)
        .build();
```

Далее требуется загрузить шаблон, в аргументах `load` и `loadFile`
нужно указать класс, который будет использован, для генерации страницы.

```java
Class<?> cls = /* ... */;

Template template;
// Файл будет взят из папки, указанной в аргументах 
// в useResources или useFiles
template = provider.load(cls, "<file name / resource name>");
```

И далее вызываем метод `render`, `renderAsString` или `renderAsBytes`, передав в него
нужный объект.

```java
Object object = /* ... */;
String output = template.renderAsString(object);
```

## В разработке
- Английский язык в документации
- Динамическое обновление шаблона
- Кэш?
- Нормальный код
- Добавить бенчмарки
- Добавить проект в maven central
- Вики?
- Больше тестов

## Связь
[ВК](https://vk.com/id623151994), 
[ТГ](https://t.me/lero4ka85)

### Post Scriptum
В данный момент проект активно разрабатывается, так что
может происходить слишком много изменений, которые могут
сломать поддержку предыдущих. Буду рада, если кто-нибудь
поможет в разработке.